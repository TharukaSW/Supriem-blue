import{a as H}from"./chunk-FURMOBJY.js";import{a as ye,b as ke,c as Le,d as Ne,e as Fe,f as Pe,g as $,h as Re}from"./chunk-S6CVKGS6.js";import{a as we,b as Ie,c as Te,d as De}from"./chunk-4IKFU3EN.js";import{a as fe,b as _e,c as Ce,d as Se,e as ge,f as he,g as xe,h as ve,i as Me,j as be,k as Ee}from"./chunk-XYH6MH5Y.js";import{a as ce,b as ue}from"./chunk-ZJOCXRYO.js";import{b as A,c as O,d as j,e as q}from"./chunk-K2SJH3O2.js";import{a as re,c as le,f as pe}from"./chunk-B7D3IYK4.js";import{a as F,b as me,d as se,g as P,h as R}from"./chunk-MH2VXUWF.js";import{b as k,d as L,f as N,g as Q,i as X,j as Y,l as ee,o as te,q as ie,r as ne,s as oe,t as ae,u as B,v as de,w as V}from"./chunk-HNMV2PS5.js";import{c as K}from"./chunk-ACY4WVXQ.js";import"./chunk-INZLI3TU.js";import"./chunk-RFM3TPKV.js";import"./chunk-YCMZOG5D.js";import{Fb as a,Gb as _,Ha as p,Hb as M,Ia as d,Jb as J,Kb as U,Lb as Z,Nb as T,Ra as E,Ya as s,bb as c,db as W,gb as w,ha as b,kb as o,lb as i,mb as u,nb as S,oa as x,ob as g,pa as v,qb as I,qc as D,tb as f,uc as y,vb as h}from"./chunk-6JSNIO2G.js";function ze(e,l){e&1&&(o(0,"mat-error"),a(1," Supplier code is required "),i())}function We(e,l){e&1&&(o(0,"mat-error"),a(1," Supplier name is required "),i())}function Je(e,l){e&1&&(o(0,"mat-error"),a(1," Invalid email format "),i())}var G=(()=>{class e{fb;supplierService;snackBar;dialogRef;data;form;saving=!1;constructor(t,r,n,m,C){this.fb=t,this.supplierService=r,this.snackBar=n,this.dialogRef=m,this.data=C}ngOnInit(){this.form=this.fb.group({supplierCode:[{value:this.data.supplier?.supplierCode||"",disabled:this.data.mode==="edit"},[L.required]],supplierName:[this.data.supplier?.supplierName||"",[L.required]],contactName:[this.data.supplier?.contactName||""],phone:[this.data.supplier?.phone||""],email:[this.data.supplier?.email||"",[L.email]],address:[this.data.supplier?.address||""]})}onSave(){if(this.form.valid){this.saving=!0;let t=this.form.getRawValue();(this.data.mode==="create"?this.supplierService.create(t):this.supplierService.update(this.data.supplier.supplierId,t)).subscribe({next:()=>{this.snackBar.open(`Supplier ${this.data.mode==="create"?"created":"updated"} successfully`,"Close",{duration:3e3}),this.dialogRef.close(!0)},error:n=>{this.snackBar.open(n.error?.message||"Error saving supplier","Close",{duration:3e3}),this.saving=!1}})}}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(r){return new(r||e)(d(ne),d(H),d(j),d(ye),d(ke))};static \u0275cmp=b({type:e,selectors:[["app-supplier-form-dialog"]],standalone:!0,features:[T],decls:37,vars:7,consts:[["mat-dialog-title",""],[1,"supplier-form",3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","supplierCode","placeholder","SUP001","required",""],[4,"ngIf"],["matInput","","formControlName","supplierName","placeholder","ABC Plastics Pvt Ltd","required",""],["matInput","","formControlName","contactName","placeholder","John Smith"],[1,"form-row"],["appearance","outline",1,"half-width"],["matInput","","formControlName","phone","placeholder","+94771234567"],["matInput","","formControlName","email","type","email","placeholder","supplier@example.com"],["matInput","","formControlName","address","rows","3","placeholder","123 Industrial Zone, Colombo"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(r,n){if(r&1&&(o(0,"h2",0),a(1),i(),o(2,"mat-dialog-content")(3,"form",1)(4,"mat-form-field",2)(5,"mat-label"),a(6,"Supplier Code"),i(),u(7,"input",3),s(8,ze,2,0,"mat-error",4),i(),o(9,"mat-form-field",2)(10,"mat-label"),a(11,"Supplier Name"),i(),u(12,"input",5),s(13,We,2,0,"mat-error",4),i(),o(14,"mat-form-field",2)(15,"mat-label"),a(16,"Contact Name"),i(),u(17,"input",6),i(),o(18,"div",7)(19,"mat-form-field",8)(20,"mat-label"),a(21,"Phone"),i(),u(22,"input",9),i(),o(23,"mat-form-field",8)(24,"mat-label"),a(25,"Email"),i(),u(26,"input",10),s(27,Je,2,0,"mat-error",4),i()(),o(28,"mat-form-field",2)(29,"mat-label"),a(30,"Address"),i(),u(31,"textarea",11),i()()(),o(32,"mat-dialog-actions",12)(33,"button",13),f("click",function(){return n.onCancel()}),a(34,"Cancel"),i(),o(35,"button",14),f("click",function(){return n.onSave()}),a(36),i()()),r&2){let m,C,z;p(),_(n.data.mode==="create"?"Add New Supplier":"Edit Supplier"),p(2),c("formGroup",n.form),p(5),c("ngIf",(m=n.form.get("supplierCode"))==null?null:m.hasError("required")),p(5),c("ngIf",(C=n.form.get("supplierName"))==null?null:C.hasError("required")),p(14),c("ngIf",(z=n.form.get("email"))==null?null:z.hasError("email")),p(8),c("disabled",!n.form.valid||n.saving),p(),M(" ",n.saving?"Saving...":"Save"," ")}},dependencies:[y,D,ae,Y,k,N,Q,ie,ee,te,$,Ne,Pe,Fe,V,B,R,P,F,me,O,A,q],styles:[".supplier-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;min-width:500px;padding:20px 0}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.half-width[_ngcontent-%COMP%]{flex:1}"]})}return e})();function Ue(e,l){e&1&&(o(0,"th",20),a(1,"Code"),i())}function Ze(e,l){if(e&1&&(o(0,"td",21),a(1),i()),e&2){let t=l.$implicit;p(),_(t.supplierCode)}}function Ke(e,l){e&1&&(o(0,"th",20),a(1,"Name"),i())}function Qe(e,l){if(e&1&&(o(0,"td",21)(1,"div")(2,"strong"),a(3),i(),o(4,"div",22),a(5),i()()()),e&2){let t=l.$implicit;p(3),_(t.supplierName),p(2),_(t.contactName||"-")}}function Xe(e,l){e&1&&(o(0,"th",20),a(1,"Contact"),i())}function Ye(e,l){if(e&1&&(o(0,"td",21)(1,"div")(2,"div"),a(3),i(),o(4,"div",22),a(5),i()()()),e&2){let t=l.$implicit;p(3),_(t.phone||"-"),p(2),_(t.email||"-")}}function et(e,l){e&1&&(o(0,"th",20),a(1,"Address"),i())}function tt(e,l){if(e&1&&(o(0,"td",21),a(1),i()),e&2){let t=l.$implicit;p(),M(" ",t.address||"-"," ")}}function it(e,l){e&1&&(o(0,"th",20),a(1,"Status"),i())}function nt(e,l){if(e&1&&(o(0,"td",21)(1,"mat-chip"),a(2),i()()),e&2){let t=l.$implicit;p(),W("active",t.isActive)("inactive",!t.isActive),p(),M(" ",t.isActive?"Active":"Inactive"," ")}}function ot(e,l){e&1&&(o(0,"th",20),a(1,"Actions"),i())}function at(e,l){if(e&1){let t=I();o(0,"button",26),f("click",function(){x(t);let n=h().$implicit,m=h();return v(m.deactivateSupplier(n))}),o(1,"mat-icon"),a(2,"block"),i()()}}function rt(e,l){if(e&1){let t=I();o(0,"td",21)(1,"button",23),f("click",function(){let n=x(t).$implicit,m=h();return v(m.viewSupplier(n))}),o(2,"mat-icon"),a(3,"visibility"),i()(),o(4,"button",24),f("click",function(){let n=x(t).$implicit,m=h();return v(m.editSupplier(n))}),o(5,"mat-icon"),a(6,"edit"),i()(),s(7,at,3,0,"button",25),i()}if(e&2){let t=l.$implicit;p(7),c("ngIf",t.isActive)}}function lt(e,l){e&1&&u(0,"tr",27)}function pt(e,l){e&1&&u(0,"tr",28)}function mt(e,l){if(e&1){let t=I();o(0,"button",2),f("click",function(){x(t);let n=h(2);return v(n.addSupplier())}),a(1," Add First Supplier "),i()}}function st(e,l){if(e&1&&(o(0,"div",18)(1,"mat-icon"),a(2,"local_shipping"),i(),o(3,"p"),a(4),i(),s(5,mt,2,0,"button",29),i()),e&2){let t=h();p(4),_(t.searchText?"No suppliers found":"No suppliers added yet"),p(),w(t.searchText?-1:5)}}function dt(e,l){e&1&&(o(0,"div",19)(1,"p"),a(2,"Loading suppliers..."),i()())}var $t=(()=>{class e{router;supplierService;dialog;snackBar;suppliers=E([]);filteredSuppliers=E([]);loading=E(!1);searchText="";displayedColumns=["code","name","contact","address","status","actions"];constructor(t,r,n,m){this.router=t,this.supplierService=r,this.dialog=n,this.snackBar=m}ngOnInit(){this.loadSuppliers()}loadSuppliers(){this.loading.set(!0),this.supplierService.getAll().subscribe({next:t=>{let r=Array.isArray(t)?t:t.data||[];this.suppliers.set(r),this.filteredSuppliers.set(r),this.loading.set(!1)},error:()=>{this.snackBar.open("Error loading suppliers","Close",{duration:3e3}),this.loading.set(!1)}})}applyFilter(){let t=this.searchText.toLowerCase(),r=this.suppliers().filter(n=>n.supplierCode.toLowerCase().includes(t)||n.supplierName.toLowerCase().includes(t)||n.contactName&&n.contactName.toLowerCase().includes(t));this.filteredSuppliers.set(r)}addSupplier(){this.dialog.open(G,{width:"600px",data:{mode:"create"}}).afterClosed().subscribe(r=>{r&&this.loadSuppliers()})}viewSupplier(t){this.router.navigate(["/suppliers",t.supplierId])}editSupplier(t){this.dialog.open(G,{width:"600px",data:{mode:"edit",supplier:t}}).afterClosed().subscribe(n=>{n&&this.loadSuppliers()})}deactivateSupplier(t){this.dialog.open(Re,{data:{title:"Deactivate Supplier",message:`Are you sure you want to deactivate ${t.supplierName}?`,confirmText:"Deactivate"}}).afterClosed().subscribe(n=>{n&&this.supplierService.deactivate(t.supplierId).subscribe({next:()=>{this.snackBar.open("Supplier deactivated successfully","Close",{duration:3e3}),this.loadSuppliers()},error:()=>{this.snackBar.open("Error deactivating supplier","Close",{duration:3e3})}})})}static \u0275fac=function(r){return new(r||e)(d(K),d(H),d(Le),d(j))};static \u0275cmp=b({type:e,selectors:[["app-suppliers-list"]],standalone:!0,features:[T],decls:40,vars:6,consts:[[1,"page-container"],[1,"page-header"],["mat-raised-button","","color","primary",3,"click"],[1,"filters"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by code or name...",3,"ngModelChange","input","ngModel"],["matSuffix",""],["mat-table","",1,"suppliers-table",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","contact"],["matColumnDef","address"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","clickable-row",4,"matRowDef","matRowDefColumns"],[1,"no-data"],[1,"loading"],["mat-header-cell",""],["mat-cell",""],[1,"text-muted"],["mat-icon-button","","matTooltip","View Details",3,"click"],["mat-icon-button","","matTooltip","Edit",3,"click"],["mat-icon-button","","matTooltip","Deactivate","color","warn",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Deactivate","color","warn",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable-row"],["mat-raised-button","","color","primary"]],template:function(r,n){r&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Suppliers"),i(),o(4,"button",2),f("click",function(){return n.addSupplier()}),o(5,"mat-icon"),a(6,"add"),i(),a(7," Add Supplier "),i()(),o(8,"mat-card")(9,"mat-card-content")(10,"div",3)(11,"mat-form-field",4)(12,"mat-label"),a(13,"Search Suppliers"),i(),o(14,"input",5),Z("ngModelChange",function(C){return U(n.searchText,C)||(n.searchText=C),C}),f("input",function(){return n.applyFilter()}),i(),o(15,"mat-icon",6),a(16,"search"),i()()(),o(17,"table",7),S(18,8),s(19,Ue,2,0,"th",9)(20,Ze,2,1,"td",10),g(),S(21,11),s(22,Ke,2,0,"th",9)(23,Qe,6,2,"td",10),g(),S(24,12),s(25,Xe,2,0,"th",9)(26,Ye,6,2,"td",10),g(),S(27,13),s(28,et,2,0,"th",9)(29,tt,2,1,"td",10),g(),S(30,14),s(31,it,2,0,"th",9)(32,nt,3,5,"td",10),g(),S(33,15),s(34,ot,2,0,"th",9)(35,rt,8,1,"td",10),g(),s(36,lt,1,0,"tr",16)(37,pt,1,0,"tr",17),i(),s(38,st,6,2,"div",18)(39,dt,3,0,"div",19),i()()()),r&2&&(p(14),J("ngModel",n.searchText),p(3),c("dataSource",n.filteredSuppliers()),p(19),c("matHeaderRowDef",n.displayedColumns),p(),c("matRowDefColumns",n.displayedColumns),p(),w(n.filteredSuppliers().length===0&&!n.loading()?38:-1),p(),w(n.loading()?39:-1))},dependencies:[y,D,oe,k,N,X,pe,re,le,ue,ce,V,B,de,Ee,fe,Ce,xe,Se,_e,ve,ge,he,Me,be,De,Te,Ie,we,R,P,F,se,O,A,$,q],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:28px}.filters[_ngcontent-%COMP%]{margin-bottom:16px}.search-field[_ngcontent-%COMP%]{width:400px}.suppliers-table[_ngcontent-%COMP%]{width:100%}.text-muted[_ngcontent-%COMP%]{color:#666;font-size:.9em}mat-chip.active[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}mat-chip.inactive[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.clickable-row[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;cursor:pointer}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#999}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}"]})}return e})();export{$t as SuppliersListComponent};
